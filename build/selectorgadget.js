function diff_match_patch(){function e(){var e=0,t=1,n=2;while(t!=n)e++,t=n,n<<=1;return e}this.Diff_Timeout=1,this.Diff_EditCost=4,this.Diff_DualThreshold=32,this.Match_Balance=.5,this.Match_Threshold=.5,this.Match_MinLength=100,this.Match_MaxLength=1e3,this.Patch_Margin=4,this.Match_MaxBits=e()}function patch_obj(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}function DomPredictionHelper(){}function SelectorGadget(){this.border_width=5,this.border_padding=2,this.b_top=null,this.b_left=null,this.b_right=null,this.b_bottom=null,this.selected=[],this.rejected=[],this.special_mode=null,this.path_output_field=null,this.sg_div=null,this.ignore_class="selectorgadget_ignore",this.unbound=!1,this.prediction_helper=new DomPredictionHelper,this.restricted_elements=jQuerySG.map(["html","body","head","base"],function(e){return jQuerySG(e).get(0)})}var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;diff_match_patch.prototype.diff_main=function(e,t,n){if(e==t)return[[DIFF_EQUAL,e]];typeof n=="undefined"&&(n=!0);var r=n,i=this.diff_commonPrefix(e,t),s=e.substring(0,i);e=e.substring(i),t=t.substring(i),i=this.diff_commonSuffix(e,t);var o=e.substring(e.length-i);e=e.substring(0,e.length-i),t=t.substring(0,t.length-i);var u=this.diff_compute(e,t,r);return s&&u.unshift([DIFF_EQUAL,s]),o&&u.push([DIFF_EQUAL,o]),this.diff_cleanupMerge(u),u},diff_match_patch.prototype.diff_compute=function(e,t,n){var r;if(!e)return[[DIFF_INSERT,t]];if(!t)return[[DIFF_DELETE,e]];var i=e.length>t.length?e:t,s=e.length>t.length?t:e,o=i.indexOf(s);if(o!=-1)return r=[[DIFF_INSERT,i.substring(0,o)],[DIFF_EQUAL,s],[DIFF_INSERT,i.substring(o+s.length)]],e.length>t.length&&(r[0][0]=r[2][0]=DIFF_DELETE),r;i=s=null;var u=this.diff_halfMatch(e,t);if(u){var a=u[0],f=u[1],l=u[2],c=u[3],h=u[4],p=this.diff_main(a,l,n),d=this.diff_main(f,c,n);return p.concat([[DIFF_EQUAL,h]],d)}n&&(e.length<100||t.length<100)&&(n=!1);var v;if(n){var m=this.diff_linesToChars(e,t);e=m[0],t=m[1],v=m[2]}r=this.diff_map(e,t),r||(r=[[DIFF_DELETE,e],[DIFF_INSERT,t]]);if(n){this.diff_charsToLines(r,v),this.diff_cleanupSemantic(r),r.push([DIFF_EQUAL,""]);var g=0,y=0,b=0,w="",E="";while(g<r.length){switch(r[g][0]){case DIFF_INSERT:b++,E+=r[g][1];break;case DIFF_DELETE:y++,w+=r[g][1];break;case DIFF_EQUAL:if(y>=1&&b>=1){var m=this.diff_main(w,E,!1);r.splice(g-y-b,y+b),g=g-y-b;for(var S=m.length-1;S>=0;S--)r.splice(g,0,m[S]);g+=m.length}b=0,y=0,w="",E=""}g++}r.pop()}return r},diff_match_patch.prototype.diff_linesToChars=function(e,t){function i(e){var t="",i=0,s=-1,o=n.length;while(s<e.length-1){s=e.indexOf("\n",i),s==-1&&(s=e.length-1);var u=e.substring(i,s+1);i=s+1,(r.hasOwnProperty?r.hasOwnProperty(u):r[u]!==undefined)?t+=String.fromCharCode(r[u]):(t+=String.fromCharCode(o),r[u]=o,n[o++]=u)}return t}var n=[],r={};n[0]="";var s=i(e),o=i(t);return[s,o,n]},diff_match_patch.prototype.diff_charsToLines=function(e,t){for(var n=0;n<e.length;n++){var r=e[n][1],i=[];for(var s=0;s<r.length;s++)i[s]=t[r.charCodeAt(s)];e[n][1]=i.join("")}},diff_match_patch.prototype.diff_map=function(e,t){var n=(new Date).getTime()+this.Diff_Timeout*1e3,r=e.length+t.length-1,i=this.Diff_DualThreshold*2<r,s=[],o=[],u={},a={};u[1]=0,a[1]=0;var f,l,c,h={},p=!1,d=!!h.hasOwnProperty,v=(e.length+t.length)%2;for(var m=0;m<r;m++){if(this.Diff_Timeout>0&&(new Date).getTime()>n)return null;s[m]={};for(var g=-m;g<=m;g+=2){g==-m||g!=m&&u[g-1]<u[g+1]?f=u[g+1]:f=u[g-1]+1,l=f-g,i&&(c=f+","+l,v&&(d?h.hasOwnProperty(c):h[c]!==undefined)&&(p=!0),v||(h[c]=m));while(!p&&f<e.length&&l<t.length&&e.charAt(f)==t.charAt(l))f++,l++,i&&(c=f+","+l,v&&(d?h.hasOwnProperty(c):h[c]!==undefined)&&(p=!0),v||(h[c]=m));u[g]=f,s[m][f+","+l]=!0;if(f==e.length&&l==t.length)return this.diff_path1(s,e,t);if(p){o=o.slice(0,h[c]+1);var y=this.diff_path1(s,e.substring(0,f),t.substring(0,l));return y.concat(this.diff_path2(o,e.substring(f),t.substring(l)))}}if(i){o[m]={};for(var g=-m;g<=m;g+=2){g==-m||g!=m&&a[g-1]<a[g+1]?f=a[g+1]:f=a[g-1]+1,l=f-g,c=e.length-f+","+(t.length-l),!v&&(d?h.hasOwnProperty(c):h[c]!==undefined)&&(p=!0),v&&(h[c]=m);while(!p&&f<e.length&&l<t.length&&e.charAt(e.length-f-1)==t.charAt(t.length-l-1))f++,l++,c=e.length-f+","+(t.length-l),!v&&(d?h.hasOwnProperty(c):h[c]!==undefined)&&(p=!0),v&&(h[c]=m);a[g]=f,o[m][f+","+l]=!0;if(p){s=s.slice(0,h[c]+1);var y=this.diff_path1(s,e.substring(0,e.length-f),t.substring(0,t.length-l));return y.concat(this.diff_path2(o,e.substring(e.length-f),t.substring(t.length-l)))}}}}return null},diff_match_patch.prototype.diff_path1=function(e,t,n){var r=[],i=t.length,s=n.length,o=null;for(var u=e.length-2;u>=0;u--)for(;;){if(e[u].hasOwnProperty?e[u].hasOwnProperty(i-1+","+s):e[u][i-1+","+s]!==undefined){i--,o===DIFF_DELETE?r[0][1]=t.charAt(i)+r[0][1]:r.unshift([DIFF_DELETE,t.charAt(i)]),o=DIFF_DELETE;break}if(e[u].hasOwnProperty?e[u].hasOwnProperty(i+","+(s-1)):e[u][i+","+(s-1)]!==undefined){s--,o===DIFF_INSERT?r[0][1]=n.charAt(s)+r[0][1]:r.unshift([DIFF_INSERT,n.charAt(s)]),o=DIFF_INSERT;break}i--,s--,o===DIFF_EQUAL?r[0][1]=t.charAt(i)+r[0][1]:r.unshift([DIFF_EQUAL,t.charAt(i)]),o=DIFF_EQUAL}return r},diff_match_patch.prototype.diff_path2=function(e,t,n){var r=[],i=0,s=t.length,o=n.length,u=null;for(var a=e.length-2;a>=0;a--)for(;;){if(e[a].hasOwnProperty?e[a].hasOwnProperty(s-1+","+o):e[a][s-1+","+o]!==undefined){s--,u===DIFF_DELETE?r[i-1][1]+=t.charAt(t.length-s-1):r[i++]=[DIFF_DELETE,t.charAt(t.length-s-1)],u=DIFF_DELETE;break}if(e[a].hasOwnProperty?e[a].hasOwnProperty(s+","+(o-1)):e[a][s+","+(o-1)]!==undefined){o--,u===DIFF_INSERT?r[i-1][1]+=n.charAt(n.length-o-1):r[i++]=[DIFF_INSERT,n.charAt(n.length-o-1)],u=DIFF_INSERT;break}s--,o--,u===DIFF_EQUAL?r[i-1][1]+=t.charAt(t.length-s-1):r[i++]=[DIFF_EQUAL,t.charAt(t.length-s-1)],u=DIFF_EQUAL}return r},diff_match_patch.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charCodeAt(0)!==t.charCodeAt(0))return 0;var n=0,r=Math.min(e.length,t.length),i=r,s=0;while(n<i)e.substring(s,i)==t.substring(s,i)?(n=i,s=n):r=i,i=Math.floor((r-n)/2+n);return i},diff_match_patch.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charCodeAt(e.length-1)!==t.charCodeAt(t.length-1))return 0;var n=0,r=Math.min(e.length,t.length),i=r,s=0;while(n<i)e.substring(e.length-i,e.length-s)==t.substring(t.length-i,t.length-s)?(n=i,s=n):r=i,i=Math.floor((r-n)/2+n);return i},diff_match_patch.prototype.diff_halfMatch=function(e,t){function s(e,t,n){var r=e.substring(n,n+Math.floor(e.length/4)),s=-1,o="",u,a,f,l;while((s=t.indexOf(r,s+1))!=-1){var c=i.diff_commonPrefix(e.substring(n),t.substring(s)),h=i.diff_commonSuffix(e.substring(0,n),t.substring(0,s));o.length<h+c&&(o=t.substring(s-h,s)+t.substring(s,s+c),u=e.substring(0,n-h),a=e.substring(n+c),f=t.substring(0,s-h),l=t.substring(s+c))}return o.length>=e.length/2?[u,a,f,l,o]:null}var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<10||r.length<1)return null;var i=this,o=s(n,r,Math.ceil(n.length/4)),u=s(n,r,Math.ceil(n.length/2)),a;if(!o&&!u)return null;u?o?a=o[4].length>u[4].length?o:u:a=u:a=o;var f,l,c,h;e.length>t.length?(f=a[0],l=a[1],c=a[2],h=a[3]):(c=a[0],h=a[1],f=a[2],l=a[3]);var p=a[4];return[f,l,c,h,p]},diff_match_patch.prototype.diff_cleanupSemantic=function(e){var t=!1,n=[],r=0,i=null,s=0,o=0,u=0;while(s<e.length)e[s][0]==DIFF_EQUAL?(n[r++]=s,o=u,u=0,i=e[s][1]):(u+=e[s][1].length,i!==null&&i.length<=o&&i.length<=u&&(e.splice(n[r-1],0,[DIFF_DELETE,i]),e[n[r-1]+1][0]=DIFF_INSERT,r--,r--,s=r>0?n[r-1]:-1,o=0,u=0,i=null,t=!0)),s++;t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e)},diff_match_patch.prototype.diff_cleanupSemanticLossless=function(e){function o(e,o){if(!e||!o)return 5;var u=0;if(e.charAt(e.length-1).match(t)||o.charAt(0).match(t)){u++;if(e.charAt(e.length-1).match(n)||o.charAt(0).match(n)){u++;if(e.charAt(e.length-1).match(r)||o.charAt(0).match(r))u++,(e.match(i)||o.match(s))&&u++}}return u}var t=/[^a-zA-Z0-9]/,n=/\s/,r=/[\r\n]/,i=/\n\r?\n$/,s=/^\r?\n\r?\n/,u=1;while(u<e.length-1){if(e[u-1][0]==DIFF_EQUAL&&e[u+1][0]==DIFF_EQUAL){var a=e[u-1][1],f=e[u][1],l=e[u+1][1],c=this.diff_commonSuffix(a,f);if(c){var h=f.substring(f.length-c);a=a.substring(0,a.length-c),f=h+f.substring(0,f.length-c),l=h+l}var p=a,d=f,v=l,m=o(a,f)+o(f,l);while(f.charAt(0)===l.charAt(0)){a+=f.charAt(0),f=f.substring(1)+l.charAt(0),l=l.substring(1);var g=o(a,f)+o(f,l);g>=m&&(m=g,p=a,d=f,v=l)}e[u-1][1]!=p&&(p?e[u-1][1]=p:(e.splice(u-1,1),u--),e[u][1]=d,v?e[u+1][1]=v:(e.splice(u+1,1),u--))}u++}},diff_match_patch.prototype.diff_cleanupEfficiency=function(e){var t=!1,n=[],r=0,i="",s=0,o=!1,u=!1,a=!1,f=!1;while(s<e.length)e[s][0]==DIFF_EQUAL?(e[s][1].length<this.Diff_EditCost&&(a||f)?(n[r++]=s,o=a,u=f,i=e[s][1]):(r=0,i=""),a=f=!1):(e[s][0]==DIFF_DELETE?f=!0:a=!0,i&&(o&&u&&a&&f||i.length<this.Diff_EditCost/2&&o+u+a+f==3)&&(e.splice(n[r-1],0,[DIFF_DELETE,i]),e[n[r-1]+1][0]=DIFF_INSERT,r--,i="",o&&u?(a=f=!0,r=0):(r--,s=r>0?n[r-1]:-1,a=f=!1),t=!0)),s++;t&&this.diff_cleanupMerge(e)},diff_match_patch.prototype.diff_cleanupMerge=function(e){e.push([DIFF_EQUAL,""]);var t=0,n=0,r=0,i="",s="",o;while(t<e.length)switch(e[t][0]){case DIFF_INSERT:r++,s+=e[t][1],t++;break;case DIFF_DELETE:n++,i+=e[t][1],t++;break;case DIFF_EQUAL:n!==0||r!==0?(n!==0&&r!==0&&(o=this.diff_commonPrefix(s,i),o!==0&&(t-n-r>0&&e[t-n-r-1][0]==DIFF_EQUAL?e[t-n-r-1][1]+=s.substring(0,o):(e.splice(0,0,[DIFF_EQUAL,s.substring(0,o)]),t++),s=s.substring(o),i=i.substring(o)),o=this.diff_commonSuffix(s,i),o!==0&&(e[t][1]=s.substring(s.length-o)+e[t][1],s=s.substring(0,s.length-o),i=i.substring(0,i.length-o))),n===0?e.splice(t-n-r,n+r,[DIFF_INSERT,s]):r===0?e.splice(t-n-r,n+r,[DIFF_DELETE,i]):e.splice(t-n-r,n+r,[DIFF_DELETE,i],[DIFF_INSERT,s]),t=t-n-r+(n?1:0)+(r?1:0)+1):t!==0&&e[t-1][0]==DIFF_EQUAL?(e[t-1][1]+=e[t][1],e.splice(t,1)):t++,r=0,n=0,i="",s=""}e[e.length-1][1]===""&&e.pop();var u=!1;t=1;while(t<e.length-1)e[t-1][0]==DIFF_EQUAL&&e[t+1][0]==DIFF_EQUAL&&(e[t][1].substring(e[t][1].length-e[t-1][1].length)==e[t-1][1]?(e[t][1]=e[t-1][1]+e[t][1].substring(0,e[t][1].length-e[t-1][1].length),e[t+1][1]=e[t-1][1]+e[t+1][1],e.splice(t-1,1),u=!0):e[t][1].substring(0,e[t+1][1].length)==e[t+1][1]&&(e[t-1][1]+=e[t+1][1],e[t][1]=e[t][1].substring(e[t+1][1].length)+e[t+1][1],e.splice(t+1,1),u=!0)),t++;u&&this.diff_cleanupMerge(e)},diff_match_patch.prototype.diff_xIndex=function(e,t){var n=0,r=0,i=0,s=0,o;for(o=0;o<e.length;o++){e[o][0]!==DIFF_INSERT&&(n+=e[o][1].length),e[o][0]!==DIFF_DELETE&&(r+=e[o][1].length);if(n>t)break;i=n,s=r}return e.length!=o&&e[o][0]===DIFF_DELETE?s:s+(t-i)},diff_match_patch.prototype.diff_prettyHtml=function(e){var t=[],n=0;for(var r=0;r<e.length;r++){var i=e[r][0],s=e[r][1],o=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"&para;<BR>");switch(i){case DIFF_INSERT:t[r]='<INS STYLE="background:#E6FFE6;" TITLE="i='+n+'">'+o+"</INS>";break;case DIFF_DELETE:t[r]='<DEL STYLE="background:#FFE6E6;" TITLE="i='+n+'">'+o+"</DEL>";break;case DIFF_EQUAL:t[r]='<SPAN TITLE="i='+n+'">'+o+"</SPAN>"}i!==DIFF_DELETE&&(n+=s.length)}return t.join("")},diff_match_patch.prototype.diff_text1=function(e){var t=[];for(var n=0;n<e.length;n++)e[n][0]!==DIFF_INSERT&&(t[n]=e[n][1]);return t.join("")},diff_match_patch.prototype.diff_text2=function(e){var t=[];for(var n=0;n<e.length;n++)e[n][0]!==DIFF_DELETE&&(t[n]=e[n][1]);return t.join("")},diff_match_patch.prototype.diff_toDelta=function(e){var t=[];for(var n=0;n<e.length;n++)switch(e[n][0]){case DIFF_INSERT:t[n]="+"+encodeURI(e[n][1]);break;case DIFF_DELETE:t[n]="-"+e[n][1].length;break;case DIFF_EQUAL:t[n]="="+e[n][1].length}return t.join("	").replace(/\0/g,"%00").replace(/%20/g," ")},diff_match_patch.prototype.diff_fromDelta=function(e,t){var n=[],r=0,i=0;t=t.replace(/%00/g,"\0");var s=t.split(/\t/g);for(var o=0;o<s.length;o++){var u=s[o].substring(1);switch(s[o].charAt(0)){case"+":try{n[r++]=[DIFF_INSERT,decodeURI(u)]}catch(a){throw new Error("Illegal escape in diff_fromDelta: "+u)}break;case"-":case"=":var f=parseInt(u,10);if(isNaN(f)||f<0)throw new Error("Invalid number in diff_fromDelta: "+u);var l=e.substring(i,i+=f);s[o].charAt(0)=="="?n[r++]=[DIFF_EQUAL,l]:n[r++]=[DIFF_DELETE,l];break;default:if(s[o])throw new Error("Invalid diff operation in diff_fromDelta: "+s[o])}}if(i!=e.length)throw new Error("Delta length ("+i+") does not equal source text length ("+e.length+").");return n},diff_match_patch.prototype.match_main=function(e,t,n){return n=Math.max(0,Math.min(n,e.length-t.length)),e==t?0:e.length===0?null:e.substring(n,n+t.length)==t?n:this.match_bitap(e,t,n)},diff_match_patch.prototype.match_bitap=function(e,t,n){function o(e,r){var o=Math.abs(n-r);return e/t.length/s.Match_Balance+o/i/(1-s.Match_Balance)}if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var r=this.match_alphabet(t),i=e.length;i=Math.max(i,this.Match_MinLength),i=Math.min(i,this.Match_MaxLength);var s=this,u=this.Match_Threshold,a=e.indexOf(t,n);a!=-1&&(u=Math.min(o(0,a),u)),a=e.lastIndexOf(t,n+t.length),a!=-1&&(u=Math.min(o(0,a),u));var f=1<<t.length-1;a=null;var l,c,h=Math.max(n+n,e.length),p;for(var d=0;d<t.length;d++){var v=Array(e.length);l=n,c=h;while(l<c)o(d,c)<u?l=c:h=c,c=Math.floor((h-l)/2+l);h=c;var m=Math.max(0,n-(c-n)-1),g=Math.min(e.length-1,t.length+c);e.charAt(g)==t.charAt(t.length-1)?v[g]=(1<<d+1)-1:v[g]=(1<<d)-1;for(var y=g-1;y>=m;y--){d===0?v[y]=(v[y+1]<<1|1)&r[e.charAt(y)]:v[y]=(v[y+1]<<1|1)&r[e.charAt(y)]|(p[y+1]<<1|1)|(p[y]<<1|1)|p[y+1];if(v[y]&f){var b=o(d,y);if(b<=u){u=b,a=y;if(!(y>n))break;m=Math.max(0,n-(y-n))}}}if(o(d+1,n)>u)break;p=v}return a},diff_match_patch.prototype.match_alphabet=function(e){var t={};for(var n=0;n<e.length;n++)t[e.charAt(n)]=0;for(var n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},diff_match_patch.prototype.patch_addContext=function(e,t){var n=t.substring(e.start2,e.start2+e.length1),r=0;while(t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin)r+=this.Patch_Margin,n=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin;var i=t.substring(e.start2-r,e.start2);i!==""&&e.diffs.unshift([DIFF_EQUAL,i]);var s=t.substring(e.start2+e.length1,e.start2+e.length1+r);s!==""&&e.diffs.push([DIFF_EQUAL,s]),e.start1-=i.length,e.start2-=i.length,e.length1+=i.length+s.length,e.length2+=i.length+s.length},diff_match_patch.prototype.patch_make=function(e,t,n){var r,i,s;typeof t=="undefined"?(s=e,r=this.diff_text1(s),i=""):(r=e,i=t,typeof n!="undefined"?s=n:(s=this.diff_main(r,i,!0),s.length>2&&(this.diff_cleanupSemantic(s),this.diff_cleanupEfficiency(s))));if(s.length===0)return[];var o=[],u=new patch_obj,a=0,f=0,l=0,c=r,h=r;for(var p=0;p<s.length;p++){var d=s[p][0],v=s[p][1];!a&&d!==DIFF_EQUAL&&(u.start1=f,u.start2=l);switch(d){case DIFF_INSERT:u.diffs[a++]=s[p],u.length2+=v.length,h=h.substring(0,l)+v+h.substring(l);break;case DIFF_DELETE:u.length1+=v.length,u.diffs[a++]=s[p],h=h.substring(0,l)+h.substring(l+v.length);break;case DIFF_EQUAL:v.length<=2*this.Patch_Margin&&a&&s.length!=p+1?(u.diffs[a++]=s[p],u.length1+=v.length,u.length2+=v.length):v.length>=2*this.Patch_Margin&&a&&(this.patch_addContext(u,c),o.push(u),u=new patch_obj,a=0,c=h)}d!==DIFF_INSERT&&(f+=v.length),d!==DIFF_DELETE&&(l+=v.length)}return a&&(this.patch_addContext(u,c),o.push(u)),o},diff_match_patch.prototype.patch_apply=function(e,t){if(e.length==0)return[t,[]];var n=[];for(var r=0;r<e.length;r++){var i=e[r],s=new patch_obj;s.diffs=i.diffs.slice(),s.start1=i.start1,s.start2=i.start2,s.length1=i.length1,s.length2=i.length2,n[r]=s}e=n;var o=this.patch_addPadding(e);t=o+t+o,this.patch_splitMax(e);var u=0,a=[];for(var r=0;r<e.length;r++){var f=e[r].start2+u,l=this.diff_text1(e[r].diffs),c=this.match_main(t,l,f);if(c===null)a[r]=!1;else{a[r]=!0,u=c-f;var h=t.substring(c,c+l.length);if(l==h)t=t.substring(0,c)+this.diff_text2(e[r].diffs)+t.substring(c+l.length);else{var p=this.diff_main(l,h,!1);this.diff_cleanupSemanticLossless(p);var d=0,v;for(var m=0;m<e[r].diffs.length;m++){var g=e[r].diffs[m];g[0]!==DIFF_EQUAL&&(v=this.diff_xIndex(p,d)),g[0]===DIFF_INSERT?t=t.substring(0,c+v)+g[1]+t.substring(c+v):g[0]===DIFF_DELETE&&(t=t.substring(0,c+v)+t.substring(c+this.diff_xIndex(p,d+g[1].length))),g[0]!==DIFF_DELETE&&(d+=g[1].length)}}}}return t=t.substring(o.length,t.length-o.length),[t,a]},diff_match_patch.prototype.patch_addPadding=function(e){var t="";for(var n=0;n<this.Patch_Margin;n++)t+=String.fromCharCode(n);for(var n=0;n<e.length;n++)e[n].start1+=t.length,e[n].start2+=t.length;var r=e[0],i=r.diffs;if(i.length==0||i[0][0]!=DIFF_EQUAL)i.unshift([DIFF_EQUAL,t]),r.start1-=t.length,r.start2-=t.length,r.length1+=t.length,r.length2+=t.length;else if(t.length>i[0][1].length){var s=t.length-i[0][1].length;i[0][1]=t.substring(i[0][1].length)+i[0][1],r.start1-=s,r.start2-=s,r.length1+=s,r.length2+=s}r=e[e.length-1],i=r.diffs;if(i.length==0||i[i.length-1][0]!=DIFF_EQUAL)i.push([DIFF_EQUAL,t]),r.length1+=t.length,r.length2+=t.length;else if(t.length>i[i.length-1][1].length){var s=t.length-i[i.length-1][1].length;i[i.length-1][1]+=t.substring(0,s),r.length1+=s,r.length2+=s}return t},diff_match_patch.prototype.patch_splitMax=function(e){for(var t=0;t<e.length;t++)if(e[t].length1>this.Match_MaxBits){var n=e[t];e.splice(t,1);var r=this.Match_MaxBits,i=n.start1,s=n.start2,o="";while(n.diffs.length!==0){var u=new patch_obj,a=!0;u.start1=i-o.length,u.start2=s-o.length,o!==""&&(u.length1=u.length2=o.length,u.diffs.push([DIFF_EQUAL,o]));while(n.diffs.length!==0&&u.length1<r-this.Patch_Margin){var f=n.diffs[0][0],l=n.diffs[0][1];f===DIFF_INSERT?(u.length2+=l.length,s+=l.length,u.diffs.push(n.diffs.shift()),a=!1):(l=l.substring(0,r-u.length1-this.Patch_Margin),u.length1+=l.length,i+=l.length,f===DIFF_EQUAL?(u.length2+=l.length,s+=l.length):a=!1,u.diffs.push([f,l]),l==n.diffs[0][1]?n.diffs.shift():n.diffs[0][1]=n.diffs[0][1].substring(l.length))}o=this.diff_text2(u.diffs),o=o.substring(o.length-this.Patch_Margin);var c=this.diff_text1(n.diffs).substring(0,this.Patch_Margin);c!==""&&(u.length1+=c.length,u.length2+=c.length,u.diffs.length!==0&&u.diffs[u.diffs.length-1][0]===DIFF_EQUAL?u.diffs[u.diffs.length-1][1]+=c:u.diffs.push([DIFF_EQUAL,c])),a||e.splice(t++,0,u)}}},diff_match_patch.prototype.patch_toText=function(e){var t=[];for(var n=0;n<e.length;n++)t[n]=e[n];return t.join("")},diff_match_patch.prototype.patch_fromText=function(e){var t=[];if(!e)return t;e=e.replace(/%00/g,"\0");var n=e.split("\n"),r=0;while(r<n.length){var i=n[r].match(/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/);if(!i)throw new Error("Invalid patch string: "+n[r]);var s=new patch_obj;t.push(s),s.start1=parseInt(i[1],10),i[2]===""?(s.start1--,s.length1=1):i[2]=="0"?s.length1=0:(s.start1--,s.length1=parseInt(i[2],10)),s.start2=parseInt(i[3],10),i[4]===""?(s.start2--,s.length2=1):i[4]=="0"?s.length2=0:(s.start2--,s.length2=parseInt(i[4],10)),r++;while(r<n.length){var o=n[r].charAt(0);try{var u=decodeURI(n[r].substring(1))}catch(a){throw new Error("Illegal escape in patch_fromText: "+u)}if(o=="-")s.diffs.push([DIFF_DELETE,u]);else if(o=="+")s.diffs.push([DIFF_INSERT,u]);else if(o==" ")s.diffs.push([DIFF_EQUAL,u]);else{if(o=="@")break;if(o!=="")throw new Error('Invalid patch mode "'+o+'" in: '+u)}r++}}return t},patch_obj.prototype.toString=function(){var e,t;this.length1===0?e=this.start1+",0":this.length1==1?e=this.start1+1:e=this.start1+1+","+this.length1,this.length2===0?t=this.start2+",0":this.length2==1?t=this.start2+1:t=this.start2+1+","+this.length2;var n=["@@ -"+e+" +"+t+" @@\n"],r;for(var i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case DIFF_INSERT:r="+";break;case DIFF_DELETE:r="-";break;case DIFF_EQUAL:r=" "}n[i+1]=r+encodeURI(this.diffs[i][1])+"\n"}return n.join("").replace(/\0/g,"%00").replace(/%20/g," ")},DomPredictionHelper.prototype=new Object,jQuerySG.expr[":"].content=function(e,t,n){var r=n[3];return r?jQuerySG.trim(jQuerySG(e).text().replace(/\s+/g," "))==r:!1},DomPredictionHelper.prototype.recursiveNodes=function(e){var t;return e.nodeName&&e.parentNode&&e!=document.body?t=this.recursiveNodes(e.parentNode):t=new Array,t.push(e),t},DomPredictionHelper.prototype.escapeCssNames=function(e){if(!e)return"";try{return e.replace(/\bselectorgadget_\w+\b/g,"").replace(/\\/g,"\\\\").replace(/[\#\;\&\,\.\+\*\~\'\:\"\!\^\$\[\]\(\)\=\>\|\/]/g,function(e){return"\\"+e}).replace(/\s+/,"")}catch(t){return window.console&&(console.log("---"),console.log("exception in escapeCssNames"),console.log(e),console.log("---")),""}},DomPredictionHelper.prototype.childElemNumber=function(e){var t=0;while(e.previousSibling&&(e=e.previousSibling))e.nodeType==1&&t++;return t},DomPredictionHelper.prototype.siblingsWithoutTextNodes=function(e){var t=e.parentNode.childNodes,n=[];for(var r=0;r<t.length;r++){if(t[r].nodeName.substring(0,1)=="#")continue;if(t[r]==e)break;n.push(t[r])}return n},DomPredictionHelper.prototype.pathOf=function(e){var t=this.recursiveNodes(e),n=this,r="";for(var i=0;i<t.length;i++){var s=t[i];if(s){var o=n.siblingsWithoutTextNodes(s);if(s.nodeName.toLowerCase()!="body")for(var u=o.length-2<0?0:o.length-2;u<o.length;u++){if(o[u]==s)break;var a=o[u].nodeName;a.match(/^(script|#.*?)$/i)||(r+=n.cssDescriptor(o[u],!0)+(u+1==o.length?"+ ":"~ "))}r+=n.cssDescriptor(s)+" > "}}return this.cleanCss(r)},DomPredictionHelper.prototype.cssDescriptor=function(e,t){var n=this,r=e.nodeName.toLowerCase(),i=e.id&&n.escapeCssNames(new String(e.id));i&&i.length>0&&(r+="#"+i),e.className&&jQuerySG.each(e.className.split(/ /),function(){var e=n.escapeCssNames(this);this&&e.length>0&&(r+="."+e)});if(t&&jQuerySG(e).contents().length<5){var s=jQuerySG.trim(jQuerySG(e).text().replace(/\s+/g," "));s.length<35&&s.length>4&&s.indexOf('"')==-1&&(r+=':content("'+this.encodeContentString(s)+'")')}return e.nodeName.toLowerCase()!="body"&&(r+=":nth-child("+(n.childElemNumber(e)+1)+")"),r},DomPredictionHelper.prototype.encodeContentString=function(e){e=e.replace(/\"/,'\\"');var t=[];for(var n=0;n<e.length;n++)t.push(e.charCodeAt(n));return t.join("-")},DomPredictionHelper.prototype.decodeContentString=function(e){var t=e.split("-"),n="";for(var r=0;r<t.length;r++)n+=String.fromCharCode(parseInt(t[r]));return n},DomPredictionHelper.prototype.decodeAllContentStrings=function(e){var t=this;return e.replace(/:content\(\"([\d\-]+)\"\)/gi,function(e,n){return':content("'+t.decodeContentString(n)+'")'})},DomPredictionHelper.prototype.cssDiff=function(e){try{var t=new diff_match_patch}catch(n){throw"Please include the diff_match_patch library."}if(typeof e=="undefined"||e.length==0)return"";var r={},i=this.encodeCssForDiff(e,r),s=i.pop();return jQuerySG.each(i,function(e){var n=t.diff_main(s,this);s="",jQuerySG.each(n,function(){this[0]==0&&(s+=this[1])})}),this.decodeCss(s,r)},DomPredictionHelper.prototype.tokenizeCss=function(e){var t=!1,n="",r=[],e=this.cleanCss(e),i=e.length,s="";for(var o=0;o<i;o++){s=e[o];if(t)t=!1;else if(s=="\\")t=!0;else if(s=="."||s==" "||s=="#"||s==">"||s==":"||s==","||s=="+"||s=="~")n.length>0&&r.push(n),n="";n+=s;if(s==" "||s==",")r.push(n),n=""}return n.length>0&&r.push(n),r},DomPredictionHelper.prototype.tokenizeCssForDiff=function(e){var t=this.tokenizeCss(e),n=[],r=[];for(var i=0;i<t.length;i++){r.push(t[i]);if(t[i]==" "&&r.length>0)n=n.concat(r),r=[];else if(t[i]=="+"||t[i]=="~")r=[r.join("")]}return r.length>0?n.concat(r):n},DomPredictionHelper.prototype.decodeCss=function(e,t){var n=this.invertObject(t),r="";return jQuerySG.each(e.split(""),function(){r+=n[this]}),this.cleanCss(r)},DomPredictionHelper.prototype.encodeCssForDiff=function(e,t){var n=50,r=this,i=[];return jQuerySG.each(e,function(){var e=new String;jQuerySG.each(r.tokenizeCssForDiff(this),function(){t[this]||(t[this]=String.fromCharCode(n++)),e+=t[this]}),i.push(e)}),i},DomPredictionHelper.prototype.tokenPriorities=function(e){var t=.001,n=new Array;for(var r=0;r<e.length;r++){var i=e[r],s=i.substring(0,1),o=i.substring(1,2);s==":"&&o=="n"?n[r]=0:s==":"&&o=="c"?n[r]=1:s==">"?n[r]=2:s=="+"||s=="~"?n[r]=3:s!=":"&&s!="."&&s!="#"&&s!=" "&&s!=">"&&s!="+"&&s!="~"?n[r]=4:s=="."?n[r]=5:(s="#")?(n[r]=6,i.match(/\d{3,}/)&&(n[r]=2.5)):n[r]=0,n[r]+=r*t}return n},DomPredictionHelper.prototype.orderFromPriorities=function(e){var t=new Array,n=new Array;for(var r=0;r<e.length;r++)t[r]={value:e[r],original:r};t.sort(function(e,t){return e.value-t.value});for(var r=0;r<e.length;r++)n[r]=t[r].original;return n},DomPredictionHelper.prototype.simplifyCss=function(e,t,n){var r=this,i=r.tokenizeCss(e),s=r.tokenPriorities(i),o=r.orderFromPriorities(s),u=r.decodeAllContentStrings(r.cleanCss(e));window.console&&console.log(u);var a=-1,f="";r.selectorGets("all",t,u)&&r.selectorGets("none",n,u)&&(f=u);var l=!0;while(l){l=!1;for(var c=0;c<i.length;c++){var h=o[c];if(i[h].length==0)continue;var p=i[h].substring(0,1),d=i[h].substring(1,2);if(p==" ")continue;if(r.wouldLeaveFreeFloatingNthChild(i,h))continue;r._removeElements(h,i,p,function(e){return window.console&&console.log("trying: "+e),r.selectorGets("all",t,e)&&r.selectorGets("none",n,e)&&(e.length<f.length||f.length==0)?(window.console&&console.log("kept: "+e),f=e,l=!0,!0):!1})}}return r.cleanCss(f)},DomPredictionHelper.prototype._removeElements=function(e,t,n,r){if(n=="+"||n=="~")var i=this.positionOfSpaceBeforeIndexOrLineStart(e,t);else var i=e;var s=t.slice(i,e+1);for(var o=i;o<=e;o++)t[o]="";selector=this.decodeAllContentStrings(this.cleanCss(t.join("")));if(selector==""||!r(selector))for(var o=i;o<=e;o++)t[o]=s[o-i];return t},DomPredictionHelper.prototype.positionOfSpaceBeforeIndexOrLineStart=function(e,t){var n=-1;for(n=e;n>=0&&t[n]!=" ";n--);return n<0&&(n=0),n},DomPredictionHelper.prototype.wouldLeaveFreeFloatingNthChild=function(e,t){var n=nth_child_is_on_right=!1;for(var r=t+1;r<e.length&&e[r].length==0;r++);r<e.length&&e[r].substring(0,2)==":n"&&(nth_child_is_on_right=!0);for(var r=t-1;r>-1&&e[r].length==0;r--);if(r<0||e[r]==" ")n=!0;return n&&nth_child_is_on_right},DomPredictionHelper.prototype.cleanCss=function(e){var t=e,n=null;while(n!=t)n=t,t=t.replace(/(^|\s+)(\+|\~)/,"").replace(/(\+|\~)\s*$/,"").replace(/>/g," > ").replace(/\s*(>\s*)+/g," > ").replace(/,/g," , ").replace(/\s+/g," ").replace(/^\s+|\s+$/g,"").replace(/\s*,$/g,"").replace(/^\s*,\s*/g,"").replace(/\s*>$/g,"").replace(/^>\s*/g,"").replace(/[\+\~\>]\s*,/g,",").replace(/[\+\~]\s*>/g,">").replace(/\s*(,\s*)+/g," , ");return t},DomPredictionHelper.prototype.getPathsFor=function(e){var t=this,n=[];return e.each(function(){this&&this.nodeName&&n.push(t.pathOf(this))}),n},DomPredictionHelper.prototype.predictCss=function(e,t){var n=this;if(e.length==0)return"";var r=n.getPathsFor(e),i=n.cssDiff(r),s=n.simplifyCss(i,e,t);if(s.length>0)return s;var o="";return e.each(function(){o=n.pathOf(this)+", "+o}),o=n.cleanCss(o),n.simplifyCss(o,e,t)},DomPredictionHelper.prototype.selectorGets=function(e,t,n){if(t.length==0&&e=="all")return!1;if(t.length==0&&e=="none")return!0;try{return e=="all"?t.not(n).length==0:!t.is(n)}catch(r){throw window.console&&console.log("Error on selector: "+n),r}},DomPredictionHelper.prototype.invertObject=function(e){var t={};return jQuerySG.each(e,function(e,n){t[n]=e}),t},DomPredictionHelper.prototype.cssToXPath=function(e){var t=this.tokenizeCss(e);t[0]&&t[0]==" "&&t.splice(0,1),t[t.length-1]&&t[t.length-1]==" "&&t.splice(t.length-1,1);var n=[],r="";for(var i=0;i<t.length;i++)t[i]==" "?(r+=this.cssToXPathBlockHelper(n),n=[]):n.push(t[i]);return r+this.cssToXPathBlockHelper(n)},DomPredictionHelper.prototype.cssToXPathBlockHelper=function(e){if(e.length==0)return"//";var t="//",n=e[0].substring(0,1);if(n==",")return" | ";jQuerySG.inArray(n,[":","#","."])!=-1&&(t+="*");var r=[],i=null;for(var s=0;s<e.length;s++){var o=e[s];n=o.substring(0,1);var u=o.substring(1);n==":"?(i=u.match(/^nth-child\((\d+)\)$/))&&r.push("(((count(preceding-sibling::*) + 1) = "+i[1]+") and parent::*)"):n=="."?r.push('contains(concat( " ", @class, " " ), concat( " ", "'+u+'", " " ))'):n=="#"?r.push('(@id = "'+u+'")'):n!=","&&(t+=o)}r.length>0&&(t+="[");for(var s=0;s<r.length;s++)t+=r[s],s<r.length-1&&(t+=" and ");return r.length>0&&(t+="]"),t},SelectorGadget.prototype=new Object,SelectorGadget.prototype.makeBorders=function(e,t){this.removeBorders(),this.setupBorders();if(e.parentNode)var n=e.parentNode.tagName.toLowerCase()+" "+e.tagName.toLowerCase();else var n=e.tagName.toLowerCase();var r=jQuerySG(e),i=r.offset(),s=i.top,o=i.left,u=r.outerWidth(),a=r.outerHeight();this.b_top.css("width",this.px(u+this.border_padding*2+this.border_width*2)).css("top",this.px(s-this.border_width-this.border_padding)).css("left",this.px(o-this.border_padding-this.border_width)),this.b_bottom.css("width",this.px(u+this.border_padding*2+this.border_width*2-5)).css("top",this.px(s+a+this.border_padding)).css("left",this.px(o-this.border_padding-this.border_width)).text(n),this.b_left.css("height",this.px(a+this.border_padding*2)).css("top",this.px(s-this.border_padding)).css("left",this.px(o-this.border_padding-this.border_width)),this.b_right.css("height",this.px(a+this.border_padding*2)).css("top",this.px(s-this.border_padding)).css("left",this.px(o+u+this.border_padding)),this.b_right.get(0).target_elem=this.b_left.get(0).target_elem=this.b_top.get(0).target_elem=this.b_bottom.get(0).target_elem=e,t||r.hasClass("selectorgadget_suggested")||r.hasClass("selectorgadget_selected")?(this.b_top.addClass("selectorgadget_border_red"),this.b_bottom.addClass("selectorgadget_border_red"),this.b_left.addClass("selectorgadget_border_red"),this.b_right.addClass("selectorgadget_border_red")):this.b_top.hasClass("selectorgadget_border_red")&&(this.b_top.removeClass("selectorgadget_border_red"),this.b_bottom.removeClass("selectorgadget_border_red"),this.b_left.removeClass("selectorgadget_border_red"),this.b_right.removeClass("selectorgadget_border_red")),this.showBorders()},SelectorGadget.prototype.px=function(e){return e+"px"},SelectorGadget.prototype.showBorders=function(){this.b_top.show(),this.b_bottom.show(),this.b_left.show(),this.b_right.show()},SelectorGadget.prototype.removeBorders=function(){this.b_top&&(this.b_top.hide(),this.b_bottom.hide(),this.b_left.hide(),this.b_right.hide())},SelectorGadget.prototype.setupBorders=function(){if(!this.b_top){var e=this.border_width+"px";this.b_top=jQuerySG("<div>").addClass("selectorgadget_border").css("height",e).hide().bind("mousedown.sg",{self:this},this.sgMousedown),this.b_bottom=jQuerySG("<div>").addClass("selectorgadget_border").addClass("selectorgadget_bottom_border").css("height",this.px(this.border_width+6)).hide().bind("mousedown.sg",{self:this},this.sgMousedown),this.b_left=jQuerySG("<div>").addClass("selectorgadget_border").css("width",e).hide().bind("mousedown.sg",{self:this},this.sgMousedown),this.b_right=jQuerySG("<div>").addClass("selectorgadget_border").css("width",e).hide().bind("mousedown.sg",{self:this},this.sgMousedown),this.addBorderToDom()}},SelectorGadget.prototype.addBorderToDom=function(){document.body.appendChild(this.b_top.get(0)),document.body.appendChild(this.b_bottom.get(0)),document.body.appendChild(this.b_left.get(0)),document.body.appendChild(this.b_right.get(0))},SelectorGadget.prototype.removeBorderFromDom=function(){this.b_top&&(this.b_top.remove(),this.b_bottom.remove(),this.b_left.remove(),this.b_right.remove(),this.b_top=this.b_bottom=this.b_left=this.b_right=null)},SelectorGadget.prototype.selectable=function(e){return!this.css_restriction||this.css_restriction&&jQuerySG(e).is(this.css_restriction)},SelectorGadget.prototype.sgMouseover=function(e){var t=e.data.self;if(t.unbound)return!0;if(this==document.body||this==document.body.parentNode)return!1;var n=jQuerySG(this);t.unhighlightIframes(),n.is("iframe")&&t.highlightIframe(n,e);if(t.special_mode!="d"){var r=t.firstSelectedOrSuggestedParent(this);r!=null&&r!=this&&t.selectable(r)?t.makeBorders(r,!0):t.selectable(n)&&t.makeBorders(this)}else jQuerySG(".selectorgadget_selected",this).get(0)||t.selectable(n)&&t.makeBorders(this);return!1},SelectorGadget.prototype.firstSelectedOrSuggestedParent=function(e){var t=e;if(jQuerySG(e).hasClass("selectorgadget_suggested")||jQuerySG(e).hasClass("selectorgadget_selected"))return e;while(e.parentNode&&(e=e.parentNode))if(jQuerySG.inArray(e,this.restricted_elements)==-1)if(jQuerySG(e).hasClass("selectorgadget_suggested")||jQuerySG(e).hasClass("selectorgadget_selected"))return e;return null},SelectorGadget.prototype.sgMouseout=function(e){var t=e.data.self;if(t.unbound)return!0;if(this==document.body||this==document.body.parentNode)return!1;var n=jQuerySG(this);return e.data.self.removeBorders(),!1},SelectorGadget.prototype.highlightIframe=function(e,t){var n=e.offset(),r=this,i=jQuerySG(t.target),s=jQuerySG("<div>").css("position","absolute").css("z-index","99998"
).css("width",this.px(e.outerWidth())).css("height",this.px(e.outerHeight())).css("top",this.px(n.top)).css("left",this.px(n.left)).css("background-color","#AAA").css("opacity","0.6").addClass("selectorgadget_iframe").addClass("selectorgadget_clean"),o=jQuerySG("<div><span>This is an iframe.  To select in it, </span></div>").css({width:"200px",border:"1px solid #888",padding:"5px","background-color":"white",position:"absolute","z-index":"99999",top:this.px(n.top+e.outerHeight()/4),left:this.px(n.left+(e.outerWidth()-200)/2),height:"150px"}).addClass("selectorgadget_iframe_info").addClass("selectorgadget_iframe").addClass("selectorgadget_clean"),u=null;try{u=e.contents().get(0).location.href}catch(a){u=e.attr("src")}o.append(jQuerySG("<a target='_top'>click here to open it</a>").attr("href",u)),o.append(jQuerySG("<span>, then relaunch SelectorGadget.</span>")),document.body.appendChild(o.get(0)),s.click(function(){r.selectable(i)&&i.mousedown()}),document.body.appendChild(s.get(0))},SelectorGadget.prototype.unhighlightIframes=function(e,t){jQuerySG(".selectorgadget_iframe").remove()},SelectorGadget.prototype.sgMousedown=function(e){var t=e.data.self;if(t.unbound)return!0;var n=this,r=jQuerySG(n);r.hasClass("selectorgadget_border")&&(n=n.target_elem||n,r=jQuerySG(n));if(n==document.body||n==document.body.parentNode)return;if(t.special_mode!="d"){var i=t.firstSelectedOrSuggestedParent(n);i!=null&&i!=n&&(n=i,r=jQuerySG(n))}else jQuerySG(".selectorgadget_selected",this).get(0)&&t.blockClicksOn(n);if(!t.selectable(r))return t.removeBorders(),t.blockClicksOn(n),!1;r.hasClass("selectorgadget_selected")?(r.removeClass("selectorgadget_selected"),t.selected.splice(jQuerySG.inArray(n,t.selected),1)):r.hasClass("selectorgadget_rejected")?(r.removeClass("selectorgadget_rejected"),t.rejected.splice(jQuerySG.inArray(n,t.rejected),1)):r.hasClass("selectorgadget_suggested")?(r.addClass("selectorgadget_rejected"),t.rejected.push(n)):(r.addClass("selectorgadget_selected"),t.selected.push(n)),t.clearSuggested();var s=t.prediction_helper.predictCss(jQuerySG(t.selected),jQuerySG(t.rejected.concat(t.restricted_elements)));return t.suggestPredicted(s),t.setPath(s),t.removeBorders(),t.blockClicksOn(n),r.trigger("mouseover.sg",{self:t}),!1},SelectorGadget.prototype.setupEventHandlers=function(){jQuerySG("*:not(.selectorgadget_ignore)").bind("mouseover.sg",{self:this},this.sgMouseover),jQuerySG("*:not(.selectorgadget_ignore)").bind("mouseout.sg",{self:this},this.sgMouseout),jQuerySG("*:not(.selectorgadget_ignore)").bind("mousedown.sg",{self:this},this.sgMousedown),jQuerySG("html").bind("keydown.sg",{self:this},this.listenForActionKeys),jQuerySG("html").bind("keyup.sg",{self:this},this.clearActionKeys)},SelectorGadget.prototype.listenForActionKeys=function(e){var t=e.data.self;if(t.unbound)return!0;if(e.keyCode==16||e.keyCode==68)t.special_mode="d",t.removeBorders()},SelectorGadget.prototype.clearActionKeys=function(e){var t=e.data.self;if(t.unbound)return!0;t.removeBorders(),t.special_mode=null},SelectorGadget.prototype.blockClicksOn=function(e){var e=jQuerySG(e),t=e.offset(),n=jQuerySG("<div>").css("position","absolute").css("z-index","9999999").css("width",this.px(e.outerWidth())).css("height",this.px(e.outerHeight())).css("top",this.px(t.top)).css("left",this.px(t.left)).css("background-color","");return document.body.appendChild(n.get(0)),setTimeout(function(){n.remove()},400),!1},SelectorGadget.prototype.setMode=function(e){e=="browse"?this.removeEventHandlers():e=="interactive"&&this.setupEventHandlers(),this.clearSelected()},SelectorGadget.prototype.suggestPredicted=function(e){if(e&&e!=""){var t=0;jQuerySG(e).each(function(){t+=1,!jQuerySG(this).hasClass("selectorgadget_selected")&&!jQuerySG(this).hasClass("selectorgadget_ignore")&&!jQuerySG(this).hasClass("selectorgadget_rejected")&&jQuerySG(this).addClass("selectorgadget_suggested")}),this.clear_button&&(t>0?this.clear_button.attr("value","Clear ("+t+")"):this.clear_button.attr("value","Clear"))}},SelectorGadget.prototype.setPath=function(e){e&&e.length>0?this.path_output_field.value=e:this.path_output_field.value="No valid path found."},SelectorGadget.prototype.refreshFromPath=function(e){var t=e&&e.data&&e.data.self||this,n=t.path_output_field.value;t.clearSelected(),t.suggestPredicted(n),t.setPath(n)},SelectorGadget.prototype.showXPath=function(e){var t=e&&e.data&&e.data.self||this,n=t.path_output_field.value;if(n=="No valid path found.")return;prompt("The CSS selector '"+n+"' as an XPath is shown below.  Please report any bugs that you find with this converter.",t.prediction_helper.cssToXPath(n))},SelectorGadget.prototype.clearSelected=function(e){var t=e&&e.data&&e.data.self||this;t.selected=[],t.rejected=[],jQuerySG(".selectorgadget_selected").removeClass("selectorgadget_selected"),jQuerySG(".selectorgadget_rejected").removeClass("selectorgadget_rejected"),t.removeBorders(),t.clearSuggested()},SelectorGadget.prototype.clearEverything=function(e){var t=e&&e.data&&e.data.self||this;t.clearSelected(),t.resetOutputs()},SelectorGadget.prototype.resetOutputs=function(){this.setPath()},SelectorGadget.prototype.clearSuggested=function(){jQuerySG(".selectorgadget_suggested").removeClass("selectorgadget_suggested"),this.clear_button&&this.clear_button.attr("value","Clear")},SelectorGadget.prototype.showHelp=function(){alert("(Better help coming soon!  Please visit http://selectorgadget.com!  Please report bugs!)\n\nClick on a page element that you would like your selector to match (it will turn green). SelectorGadget will then generate a minimal CSS selector for that element, and will highlight (yellow) everything that is matched by the selector. Now click on a highlighted element to remove it from the selector (red), or click on an unhighlighted element to add it to the selector. Through this process of selection and rejection, SelectorGadget helps you to come up with the perfect CSS selector for your needs.\n\nHolding 'shift' while moving the mouse will let you select elements inside of other selected ones.")},SelectorGadget.prototype.showOptions=function(){alert("hi!")},SelectorGadget.prototype.useRemoteInterface=function(){return window.sg_options&&window.sg_options.remote_interface},SelectorGadget.prototype.updateRemoteInterface=function(e){this.addScript(this.composeRemoteUrl(window.sg_options.remote_interface,e))},SelectorGadget.prototype.composeRemoteUrl=function(e,t){var n=e.split("?")[1]&&e.split("?")[1].split("&")||[];n.push("t="+(new Date).getTime()),n.push("url="+encodeURIComponent(window.location.href));if(t)for(var r in t)n.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));if(this.remote_data)for(var r in this.remote_data)n.push(encodeURIComponent("data["+r+"]")+"="+encodeURIComponent(this.remote_data[r]));return e.split("?")[0]+"?"+n.join("&")},SelectorGadget.prototype.addScript=function(e){var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",e);var n=document.getElementsByTagName("head")[0];n?n.appendChild(t):document.body.appendChild(t)},SelectorGadget.prototype.makeInterface=function(){this.sg_div=jQuerySG("<div>").attr("id","selectorgadget_main").addClass("selectorgadget_bottom").addClass("selectorgadget_ignore"),this.useRemoteInterface()?(this.path_output_field={value:null},this.remote_data={},this.updateRemoteInterface()):this.makeStandardInterface(),jQuerySG("body").append(this.sg_div)},SelectorGadget.prototype.makeStandardInterface=function(){var e=this,t=jQuerySG("<input>").attr("id","selectorgadget_path_field").addClass("selectorgadget_ignore").addClass("selectorgadget_input_field").keydown(function(t){if(t.keyCode==13)return e.refreshFromPath(t)}).focus(function(){jQuerySG(this).select()});this.sg_div.append(t),this.clear_button=jQuerySG('<input type="button" value="Clear"/>').bind("click",{self:this},this.clearEverything).addClass("selectorgadget_ignore").addClass("selectorgadget_input_field"),this.sg_div.append(this.clear_button),this.sg_div.append(jQuerySG('<input type="button" value="Toggle Position"/>').click(function(){e.sg_div.hasClass("selectorgadget_top")?e.sg_div.removeClass("selectorgadget_top").addClass("selectorgadget_bottom"):e.sg_div.removeClass("selectorgadget_bottom").addClass("selectorgadget_top")}).addClass("selectorgadget_ignore").addClass("selectorgadget_input_field")),this.sg_div.append(jQuerySG('<input type="button" value="XPath"/>').bind("click",{self:this},this.showXPath).addClass("selectorgadget_ignore").addClass("selectorgadget_input_field")),this.sg_div.append(jQuerySG('<input type="button" value="?"/>').bind("click",{self:this},this.showHelp).addClass("selectorgadget_ignore").addClass("selectorgadget_input_field")),this.sg_div.append(jQuerySG('<input type="button" value="Options"/>').bind("click",{self:this},this.showOptions).addClass("selectorgadget_ignore").addClass("selectorgadget_input_field")),this.sg_div.append(jQuerySG('<input type="button" value="X"/>').bind("click",{self:this},this.unbindAndRemoveInterface).addClass("selectorgadget_ignore").addClass("selectorgadget_input_field")),this.path_output_field=t.get(0)},SelectorGadget.prototype.removeInterface=function(e){this.sg_div.remove(),this.sg_div=null},SelectorGadget.prototype.unbind=function(e){var t=e&&e.data&&e.data.self||this;t.unbound=!0,t.removeBorderFromDom(),t.clearSelected()},SelectorGadget.prototype.unbindAndRemoveInterface=function(e){var t=e&&e.data&&e.data.self||this;t.unbind(),t.removeInterface()},SelectorGadget.prototype.setOutputMode=function(e,t){var n=e&&e.data&&e.data.self||this;n.output_mode=e&&e.data&&e.data.mode||t},SelectorGadget.prototype.rebind=function(){this.unbound=!1,this.clearEverything(),this.setupBorders()},SelectorGadget.prototype.rebindAndMakeInterface=function(){this.makeInterface(),this.rebind()},SelectorGadget.prototype.randBetween=function(e,t){return Math.floor(Math.random()*t)+e},SelectorGadget.prototype.analytics=function(){var e="UA-148948-9",t=encodeURIComponent("www.selectorgadget.com"),n=this.randBetween(1e9,9999999999),r=this.randBetween(1e7,99999999),i=this.randBetween(1e9,2147483647),s=Math.round((new Date).getTime()/1e3),o=encodeURIComponent(window.location.href),u="-",a="sg",f="http://www.google-analytics.com/__utm.gif?utmwv=1&utmn="+n+"&utmsr=-&utmsc=-&utmul=-&utmje=0&utmfl=-&utmdt=-&utmhn="+t+"&utmr="+o+"&utmp="+a+"&utmac="+e+"&utmcc=__utma%3D"+r+"."+i+"."+s+"."+s+"."+s+".2%3B%2B__utmb%3D"+r+"%3B%2B__utmc%3D"+r+"%3B%2B__utmz%3D"+r+"."+s+".2.2.utmccn%3D(direct)%7Cutmcsr%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D"+r+"."+u+"%3B";document.body.appendChild(jQuerySG("<img />").attr("src",f).get(0))},SelectorGadget.prototype.wizard_defaults={info_card:{close:"Let me browse to it!",next:"I'm there!",back:"Back",type:"info"},selector_card:{prompt:"Please select the %s on this page.",close:!1,next:"Skip",back:"Back"}},SelectorGadget.prototype.updateWizard=function(e){this.injectDefaultCardInfoAsNecessary(e);var t=this.selectWizardCard(e);t?(this.wizard_json=e,this.wizard_card=t,this.displayWizardCard(t)):this.unbindAndRemoveInterface()},SelectorGadget.prototype.injectDefaultCardInfoAsNecessary=function(e){for(var t=0;t<e.cards.length;t++){var n=e.cards[t];n.index=t;var r=this.wizard_defaults[this.cardType(n)];for(var i in r)if(n[i]===undefined||n[i]===null)n[i]=r[i]}},SelectorGadget.prototype.selectWizardCard=function(e){if(!e||!e.cards||e.cards.length==0)return null;var t=e.cards[0];for(var n=0;n<e.cards.length;n++)e.cards[n].name&&e.selectors&&e.selectors[e.cards[n].name]&&(n+1<e.cards.length?t=e.cards[n+1]:t=null);return t&&(t=this.handleSkipIfs(t,e)),t},SelectorGadget.prototype.handleSkipIfs=function(e,t,n){while(e&&e.skip_if&&e.skip_if(t))n=="backwards"&&e.index-1>-1?e=t.cards[e.index-1]:e=t.cards[e.index+1];return e},SelectorGadget.prototype.makePathField=function(){var e=this,t=jQuerySG("<input>").attr("id","selectorgadget_path_field").keydown(function(t){if(t.keyCode==13)return e.refreshFromPath(t)}).focus(function(){jQuerySG(this).select()});return this.path_output_field=t.get(0),t},SelectorGadget.prototype.makeClearButton=function(){return this.clear_button=jQuerySG('<input type="button" value="Clear"/>').addClass("selectorgadget_input_field").bind("click",{self:this},this.clearEverything),this.clear_button},SelectorGadget.prototype.makeRemoteSaveButton=function(e){var t=this;return jQuerySG('<input type="button" value="Save"/>').addClass("selectorgadget_input_field").click(function(){var n=t.path_output_field.value;if(n==""||n=="No valid path found.")return;t.updateRemoteInterface({selector:n,field_name:e})})},SelectorGadget.prototype.makeCloseButton=function(e){return jQuerySG('<input type="button" />').addClass("selectorgadget_input_field").attr("value",e).bind("click",{self:this},this.unbindAndRemoveInterface)},SelectorGadget.prototype.makeNextButton=function(e,t){var n=this;return jQuerySG('<input type="button" />').addClass("selectorgadget_input_field").attr("value",e).click(function(){t&&n.isSelectorCard(t)?n.updateRemoteInterface({selector:"",field_name:t.name}):t&&t.store_url&&t.name?n.updateRemoteInterface({store_url:window.location.href,field_name:t.name}):n.showNextCard()})},SelectorGadget.prototype.makeBackButton=function(e){var t=this;return jQuerySG('<input type="button" />').addClass("selectorgadget_input_field").attr("value",e).click(function(){t.showPreviousCard()})},SelectorGadget.prototype.showNextCard=function(){this.wizard_card.index+1<this.wizard_json.cards.length?(this.wizard_card=this.wizard_json.cards[this.wizard_card.index+1],this.wizard_card=this.handleSkipIfs(this.wizard_card,this.wizard_json),this.displayWizardCard(this.wizard_card)):this.unbindAndRemoveInterface()},SelectorGadget.prototype.showPreviousCard=function(){this.wizard_card.index-1>-1&&(this.wizard_card=this.wizard_json.cards[this.wizard_card.index-1],this.wizard_card=this.handleSkipIfs(this.wizard_card,this.wizard_json,"backwards"),this.displayWizardCard(this.wizard_card))},SelectorGadget.prototype.displayWizardCard=function(e){this.sg_div.html("");var t=jQuerySG("<div></div>").addClass("selectorgadget_wizard");this.clearEverything(),this.unbind(),this.css_restriction=e.restrict_css_to,t.append(jQuerySG("<div></div>").addClass("selectorgadget_prompt").html(e.prompt)),this.isSelectorCard(e)&&(t.append(this.makePathField()),t.append(this.makeClearButton()),t.append(this.makeRemoteSaveButton(e.name)),this.rebind(),this.wizard_json.selectors[e.name]&&(this.path_output_field.value=this.wizard_json.selectors[e.name],this.refreshFromPath())),e.next&&t.append(this.makeNextButton(e.next,e)),e.close&&t.append(this.makeCloseButton(e.close)),e.back&&e.index>0&&t.append(this.makeBackButton(e.back)),this.sg_div.append(t)},SelectorGadget.prototype.isSelectorCard=function(e){return e.name&&e.type!="info"?!0:!1},SelectorGadget.prototype.cardType=function(e){return this.isSelectorCard(e)?"selector_card":"info_card"};